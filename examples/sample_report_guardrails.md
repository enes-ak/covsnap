# covsnap Coverage Report

| Field | Value |
|-------|-------|
| **Tool version** | 0.1.0 |
| **Date** | 2026-02-06 15:00:00 UTC |
| **Engine** | samtools 1.19 |
| **Annotation** | GENCODE v44 (hg38) |
| **Input BAM** | `/data/wgs_sample.bam` |
| **Sample name** | HG002 |
| **Contig style** | chr-prefixed (auto-detected) |
| **Input BED** | `/data/large_panel.bed` |

## Coordinate Convention

- Input BED file coordinates are **0-based half-open** (BED standard).
- All output BED coordinates and raw TSV start/end columns use **0-based half-open**.
- Report display positions are **1-based inclusive** for readability.

---

## BED Guardrails — WARNING

The input BED file exceeded configured limits. The following action was taken:

| Limit | Configured | Actual | Exceeded? |
|-------|------------|--------|-----------|
| Max targets | 2,000 | 12,847 | **YES** |
| Max total bp | 50,000,000 | 38,221,400 (of first 2,000) | No |
| Max file size | 50 MB | 1.2 MB | No |

**Action taken:** `warn_and_clip` — retained the **first 2,000 targets** from the BED file (sorted order). Remaining 10,847 targets were skipped.

> To process all targets, increase `--max-targets 15000` or use `--on-large-bed error` to abort instead.
> To randomly sample targets, use `--on-large-bed warn_and_sample --large-bed-seed 42`.

---

## Target Summary

*(Showing first 5 of 2,000 processed targets)*

| Target | Region (1-based) | Length | Mean Depth | Median | %≥20x | %Zero | Status |
|--------|-------------------|--------|------------|--------|-------|-------|--------|
| chr1:11873-14409 | chr1:11,874-14,409 | 2,536 bp | 0.42 | 0 | 0.00% | 88.25% | **DROP_OUT** |
| chr1:14361-29370 | chr1:14,362-29,370 | 15,009 bp | 32.18 | 28 | 78.44% | 2.10% | **LOW_COVERAGE** |
| chr1:34610-36081 | chr1:34,611-36,081 | 1,471 bp | 85.60 | 82 | 98.71% | 0.00% | **PASS** |
| chr1:69090-70008 | chr1:69,091-70,008 | 918 bp | 120.33 | 45 | 96.08% | 0.33% | **UNEVEN** |
| chr1:134772-139696 | chr1:134,773-139,696 | 4,924 bp | 48.15 | 44 | 96.23% | 0.41% | **PASS** |

*(Full results in raw TSV: `covsnap.raw.tsv`)*

---

## Classification Summary

| Status | Count | Percentage |
|--------|-------|------------|
| PASS | 1,542 | 77.1% |
| LOW_COVERAGE | 298 | 14.9% |
| DROP_OUT | 87 | 4.4% |
| UNEVEN | 73 | 3.6% |

---

## Classification Heuristics Reference

| Status | Rule |
|--------|------|
| PASS | pct_ge_20 ≥ 95.0% AND pct_zero ≤ 1.0% |
| LOW_COVERAGE | pct_ge_20 < 95.0% AND pct_zero ≤ 5.0% (and not DROP_OUT) |
| DROP_OUT | pct_zero > 5.0% OR any zero-depth block ≥ 500 bp |
| UNEVEN | mean_depth > 20 AND coefficient_of_variation > 1.0 |

Evaluation order: DROP_OUT → UNEVEN → LOW_COVERAGE → PASS.

---

*Generated by covsnap 0.1.0*
