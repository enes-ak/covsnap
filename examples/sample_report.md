# covsnap Coverage Report

| Field | Value |
|-------|-------|
| **Tool version** | 0.1.0 |
| **Date** | 2026-02-06 14:30:00 UTC |
| **Engine** | mosdepth 0.3.8 |
| **Annotation** | GENCODE v44 (hg38) |
| **Input BAM** | `/data/sample.bam` |
| **Sample name** | NA12878 |
| **Contig style** | chr-prefixed (auto-detected) |
| **Reference** | N/A (BAM input) |

## Coordinate Convention

- Input region strings are interpreted as **1-based inclusive** (samtools convention).
- All output BED coordinates and raw TSV start/end columns use **0-based half-open** (BED convention).

---

## Target Summary

| Target | Region (1-based) | Length | Mean Depth | Median | %≥20x | %Zero | Status |
|--------|-------------------|--------|------------|--------|-------|-------|--------|
| BRCA1 | chr17:43,044,295-43,125,482 | 81,188 bp | 145.32 | 138 | 97.81% | 0.38% | **PASS** |
| BRCA2 | chr13:32,315,086-32,400,268 | 85,183 bp | 52.07 | 48 | 82.14% | 3.21% | **LOW_COVERAGE** |

---

## Detailed Results

### BRCA1 — PASS

Coverage is adequate across the target region.

| Metric | Value |
|--------|-------|
| Mean depth | 145.32x |
| Median depth | 138x |
| Min / Max | 0 / 612 |
| Std deviation | 42.17 |
| % at 0x | 0.38% |
| % ≥ 1x | 99.62% |
| % ≥ 5x | 99.10% |
| % ≥ 10x | 98.74% |
| % ≥ 20x | 97.81% |
| % ≥ 30x | 95.22% |
| % ≥ 50x | 82.45% |
| % ≥ 100x | 38.91% |
| Low-coverage blocks | 2 blocks, 270 bp total |

**Classification rationale:** pct_ge_20 (97.81%) ≥ 95.0% AND pct_zero (0.38%) ≤ 1.0% → PASS

### BRCA2 — LOW_COVERAGE

Coverage is below the 20x threshold across a significant fraction of the target.

| Metric | Value |
|--------|-------|
| Mean depth | 52.07x |
| Median depth | 48x |
| Min / Max | 0 / 289 |
| Std deviation | 31.44 |
| % at 0x | 3.21% |
| % ≥ 1x | 96.79% |
| % ≥ 5x | 94.55% |
| % ≥ 10x | 91.08% |
| % ≥ 20x | 82.14% |
| % ≥ 30x | 68.33% |
| % ≥ 50x | 35.70% |
| % ≥ 100x | 5.12% |
| Low-coverage blocks | 7 blocks, 4,830 bp total |

**Classification rationale:** pct_ge_20 (82.14%) < 95.0% AND pct_zero (3.21%) > 1.0% but ≤ 5.0% → LOW_COVERAGE

> **Note:** pct_zero is 3.21%, approaching the DROP_OUT threshold of 5.0%.
> Consider investigating the 7 low-coverage blocks for potential library issues.

---

## Exon-Level Results (BRCA1)

*(Shown because `--exons` was specified)*

| Exon | Exon ID | Region (1-based) | Length | Mean | %≥20x | %Zero | Flag |
|------|---------|-------------------|--------|------|-------|-------|------|
| 24 | ENSE00003896691.1 | chr17:43,044,295-43,045,802 | 1,508 bp | 152.41 | 99.47% | 0.00% | OK |
| 23 | ENSE00003654080.1 | chr17:43,047,644-43,048,474 | 831 bp | 148.77 | 99.16% | 0.00% | OK |
| 22 | ENSE00001184785.2 | chr17:43,049,121-43,049,194 | 74 bp | 78.23 | 93.24% | 0.00% | OK |
| **21** | **ENSE00003520454.1** | **chr17:43,051,063-43,051,116** | **54 bp** | **5.12** | **7.41%** | **12.96%** | **LOW_EXON** |
| 20 | ENSE00003477791.1 | chr17:43,057,052-43,057,135 | 84 bp | 141.36 | 98.81% | 0.00% | OK |

> **Warning:** Exon 21 (ENSE00003520454.1) has critically low coverage (mean 5.12x, 12.96% zero).
> This exon would cause a LOW_EXON classification for BRCA1 if exon-level status were applied.

---

## Low-Coverage Blocks

*(Shown because `--emit-lowcov` was specified; threshold: depth < 10, min length: 50 bp)*

| Target | Block (1-based) | Length | Mean Depth |
|--------|-----------------|--------|------------|
| BRCA1 | chr17:43,067,601-43,067,750 | 150 bp | 2.3x |
| BRCA1 | chr17:43,091,401-43,091,520 | 120 bp | 0.0x |
| BRCA2 | chr13:32,325,101-32,325,400 | 300 bp | 1.1x |
| BRCA2 | chr13:32,340,801-32,341,100 | 300 bp | 0.0x |
| ... | *(5 more blocks)* | | |

Full low-coverage BED written to: `covsnap.lowcov.bed`

---

## BED Guardrails

No BED guardrails were triggered (input was gene mode).

---

## Classification Heuristics Reference

| Status | Rule |
|--------|------|
| PASS | pct_ge_20 ≥ 95.0% AND pct_zero ≤ 1.0% |
| LOW_COVERAGE | pct_ge_20 < 95.0% AND pct_zero ≤ 5.0% (and not DROP_OUT) |
| DROP_OUT | pct_zero > 5.0% OR any zero-depth block ≥ 500 bp |
| UNEVEN | mean_depth > 20 AND coefficient_of_variation > 1.0 |
| LOW_EXON | (exon mode) any exon with pct_ge_20 < 90.0% or pct_zero > 5.0% |

Evaluation order: DROP_OUT → UNEVEN → LOW_EXON → LOW_COVERAGE → PASS.

---

*Generated by covsnap 0.1.0 — https://github.com/covsnap/covsnap*
